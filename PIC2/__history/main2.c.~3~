#include <16f887.h>
#fuses xt,noprotect,nowdt,nobrownout,noput,nolvp
#use delay(clock=4000000,crystal)
#use rs232(baud=57600,xmit=pin_c6,rcv=pin_c7,bits=8)
#use standard_io(B)
#use standard_io(C)
#define bobina_1 PIN_D4                      //Puertos para los motores
#define bobina_2 PIN_D5
#define bobina_3 PIN_D6
#define bobina_4 PIN_D7

void pasos_izquierda(int velocidad);
void pasos_derecha(int velocidad);
void pasos_off(void);


void pasos_izquierda(int velocidad)
{
   output_low(bobina_1);
   output_low(bobina_2);
   output_high(bobina_3);
   output_high(bobina_4);
   delay_ms(velocidad);
   
   output_low(bobina_1);
   output_high(bobina_2);
   output_high(bobina_3);
   output_low(bobina_4);
   delay_ms(velocidad);
   
   output_high(bobina_1);
   output_high(bobina_2);
   output_low(bobina_3);
   output_low(bobina_4);
   delay_ms(velocidad);
   
   output_high(bobina_1);
   output_low(bobina_2);
   output_low(bobina_3);
   output_high(bobina_4);
   delay_ms(velocidad);
}

void pasos_derecha(int velocidad)
{
   output_high(bobina_1);
   output_high(bobina_2);
   output_low(bobina_3);
   output_low(bobina_4);
   delay_ms(velocidad);
   
   output_low(bobina_1);
   output_high(bobina_2);
   output_high(bobina_3);
   output_low(bobina_4);
   delay_ms(velocidad);
   
   output_low(bobina_1);
   output_low(bobina_2);
   output_high(bobina_3);
   output_high(bobina_4);
   delay_ms(velocidad);
   
   output_high(bobina_1);
   output_low(bobina_2);
   output_low(bobina_3);
   output_high(bobina_4);
   delay_ms(velocidad);
}

void pasos_off(void)
{
   output_low(bobina_1);
   output_low(bobina_2);
   output_low(bobina_3);
   output_low(bobina_4);
}

void main()
{
   while(true)
   {
      pasos_off();
      
      if(input(pulsador_izq) == 1)
      {
         pasos_izquierda(80);
      }
      
      if(input(pulsador_der) == 1)
      {
         pasos_derecha(80);
      }
   }
}
